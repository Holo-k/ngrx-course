(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{MyK4:function(e,t,i){"use strict";i.r(t),i.d(t,"MovieModule",(function(){return te}));var s=i("ofXK"),n=i("9A8T"),o=i("tyNb"),r=i("HDdC"),c=i("quSY");let u=1;const a=(()=>Promise.resolve())(),h={};function b(e){return e in h&&(delete h[e],!0)}const d={setImmediate(e){const t=u++;return h[t]=!0,a.then(()=>b(t)&&e()),t},clearImmediate(e){b(e)}};var l=i("3N8a");class f extends l.a{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e.scheduled||(e.scheduled=d.setImmediate(e.flush.bind(e,null))))}recycleAsyncId(e,t,i=0){if(null!==i&&i>0||null===i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(d.clearImmediate(t),e.scheduled=void 0)}}var m=i("IjjT");class v extends m.a{flush(e){this.active=!0,this.scheduled=void 0;const{actions:t}=this;let i,s=-1,n=t.length;e=e||t.shift();do{if(i=e.execute(e.state,e.delay))break}while(++s<n&&(e=t.shift()));if(this.active=!1,i){for(;++s<n&&(e=t.shift());)e.unsubscribe();throw i}}}const p=new v(f);var I=i("XNiG"),w=i("qgXg"),O=i("pxpQ"),S=i("9ppp"),j=i("Ylt2");class y extends I.a{constructor(e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,i){super(),this.scheduler=i,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=e<1?1:e,this._windowTime=t<1?1:t,t===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(e){if(!this.isStopped){const t=this._events;t.push(e),t.length>this._bufferSize&&t.shift()}super.next(e)}nextTimeWindow(e){this.isStopped||(this._events.push(new g(this._getNow(),e)),this._trimBufferThenGetEvents()),super.next(e)}_subscribe(e){const t=this._infiniteTimeWindow,i=t?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,n=i.length;let o;if(this.closed)throw new S.a;if(this.isStopped||this.hasError?o=c.a.EMPTY:(this.observers.push(e),o=new j.a(this,e)),s&&e.add(e=new O.a(e,s)),t)for(let r=0;r<n&&!e.closed;r++)e.next(i[r]);else for(let r=0;r<n&&!e.closed;r++)e.next(i[r].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),o}_getNow(){return(this.scheduler||w.a).now()}_trimBufferThenGetEvents(){const e=this._getNow(),t=this._bufferSize,i=this._windowTime,s=this._events,n=s.length;let o=0;for(;o<n&&!(e-s[o].time<i);)o++;return n>t&&(o=Math.max(o,n-t)),o>0&&s.splice(0,o),s}}class g{constructor(e,t){this.time=e,this.value=t}}function x(e){return!!e&&(e instanceof r.a||"function"==typeof e.lift&&"function"==typeof e.subscribe)}var M=i("LRne"),N=i("7HRe"),$=i("z6cu"),T=i("itXk"),_=i("bOdf"),E=i("zp1y"),z=i("1G5W"),k=i("IzEk"),q=i("lJxs"),P=i("/uUt"),Y=i("fXoL");function F(){return e=>new r.a(t=>{let i,s;const n=new c.a;return n.add(e.subscribe({complete:()=>{i&&t.next(s),t.complete()},error:e=>{t.error(e)},next:e=>{s=e,i||(i=p.schedule(()=>{t.next(s),i=void 0}),n.add(i))}})),n})}const X=new Y.q("ComponentStore InitState");let W=(()=>{class e{constructor(e){this.destroySubject$=new y(1),this.destroy$=this.destroySubject$.asObservable(),this.stateSubject$=new y(1),this.isInitialized=!1,this.notInitializedErrorMessage=this.constructor.name+" has not been initialized yet. Please make sure it is initialized before updating/getting.",this.state$=this.select(e=>e),e&&this.initState(e)}ngOnDestroy(){this.stateSubject$.complete(),this.destroySubject$.next()}updater(e){return t=>{let i;const s=(x(t)?t:Object(M.a)(t)).pipe(Object(_.a)(e=>this.isInitialized?Object(N.a)([e],w.b).pipe(Object(E.a)(this.stateSubject$)):Object($.a)(new Error(this.notInitializedErrorMessage))),Object(z.a)(this.destroy$)).subscribe({next:([t,i])=>{this.stateSubject$.next(e(i,t))},error:e=>{i=e,this.stateSubject$.error(e)}});if(i)throw i;return s}}initState(e){Object(N.a)([e],w.b).subscribe(e=>{this.isInitialized=!0,this.stateSubject$.next(e)})}setState(e){"function"!=typeof e?this.initState(e):this.updater(e)()}get(e){if(!this.isInitialized)throw new Error(this.notInitializedErrorMessage);let t;return this.stateSubject$.pipe(Object(k.a)(1)).subscribe(i=>{t=e?e(i):i}),t}select(...e){const{observables:t,projector:i,config:s}=function(e){const t=Array.from(e);let i,s={debounce:!1};const n=t.pop();return"function"!=typeof n?(s=Object.assign(Object.assign({},s),n),i=t.pop()):i=n,{observables:t,projector:i,config:s}}(e);let n;return n=0===t.length?this.stateSubject$.pipe(s.debounce?F():e=>e,Object(q.a)(i)):Object(T.a)(t).pipe(s.debounce?F():e=>e,Object(q.a)(e=>i(...e))),n.pipe(Object(P.a)(),function(e,t,i){let s;return s=e&&"object"==typeof e?e:{bufferSize:e,windowTime:void 0,refCount:!1,scheduler:void 0},e=>e.lift(function({bufferSize:e=Number.POSITIVE_INFINITY,windowTime:t=Number.POSITIVE_INFINITY,refCount:i,scheduler:s}){let n,o,r=0,c=!1,u=!1;return function(a){let h;r++,!n||c?(c=!1,n=new y(e,t,s),h=n.subscribe(this),o=a.subscribe({next(e){n.next(e)},error(e){c=!0,n.error(e)},complete(){u=!0,o=void 0,n.complete()}})):h=n.subscribe(this),this.add(()=>{r--,h.unsubscribe(),o&&!u&&i&&0===r&&(o.unsubscribe(),o=void 0,n=void 0)})}}(s))}({refCount:!0,bufferSize:1}),Object(z.a)(this.destroy$))}effect(e){const t=new I.a;return e(t).pipe(Object(z.a)(this.destroy$)).subscribe(),e=>(x(e)?e:Object(M.a)(e)).pipe(Object(z.a)(this.destroy$)).subscribe(e=>{t.next(e)})}}return e.\u0275fac=function(t){return new(t||e)(Y.Sb(X,8))},e.\u0275prov=Y.Eb({token:e,factory:e.\u0275fac}),e})();const C=[{id:"m1",title:"\u9f99\u73e0"},{id:"m2",title:"\u6b7b\u795e"},{id:"m3",title:"\u94f6\u9b42"}],G=["m2"];var A=i("EY2u"),U=i("eIep"),B=i("vkgz"),V=i("JIr8"),J=i("EOjY");let D=(()=>{class e extends W{constructor(e){super({movies:[],hotIds:[]}),this.albumServe=e,this.movies$=this.select(e=>e.movies),this.hotIds$=this.select(e=>e.hotIds),this.hotMovies$=this.select(this.movies$,this.hotIds$,(e,t)=>e.filter(e=>t.includes(e.id))),this.addMovie=this.updater((e,t)=>Object.assign(Object.assign({},e),{movies:e.movies.concat(t)})),this.addMovies=this.updater((e,t)=>Object.assign(Object.assign({},e),{movies:e.movies.concat(t)})),this.addXmlyMovies=this.effect(e=>e.pipe(Object(U.a)(e=>this.albumServe.albums({category:"yinyue",subcategory:"",meta:"",sort:0,page:1,perPage:e})),Object(B.a)({next:({albums:e})=>this.addMovies(e.map(e=>({id:""+e.albumId,title:e.title}))),error:e=>console.error(e)}),Object(V.a)(()=>A.a)))}initMovie(){this.setState({movies:C,hotIds:G})}resetMovie(){this.setState({movies:[],hotIds:[]})}}return e.\u0275fac=function(t){return new(t||e)(Y.Sb(J.a))},e.\u0275prov=Y.Eb({token:e,factory:e.\u0275fac}),e})();var R=i("5weq"),H=i("40ru");function K(e,t){if(1&e&&(Y.Ob(0,"li"),Y.qc(1),Y.Nb()),2&e){const e=t.$implicit;Y.xb(1),Y.rc(e.title)}}function L(e,t){if(1&e&&(Y.Ob(0,"li"),Y.qc(1),Y.Nb()),2&e){const e=t.$implicit;Y.xb(1),Y.rc(e.title)}}const Z=[{path:"",component:(()=>{class e{constructor(e){this.movieStore=e,this.movies$=this.movieStore.movies$,this.hotMovies=this.movieStore.hotMovies$}ngOnInit(){}initMovie(){this.movieStore.initMovie()}addMovie(){this.movieStore.addMovie({id:"m4",title:"\u8fdb\u51fb\u7684\u5de8\u4eba"})}addXmlyMovies(){this.movieStore.addXmlyMovies(3)}addMovies(){this.movieStore.addMovies([{id:"m6",title:"\u6076\u9b54\u5976\u7238"},{id:"m5",title:"\u704c\u7bee\u9ad8\u624b"}])}resetMovies(){this.movieStore.resetMovie()}}return e.\u0275fac=function(t){return new(t||e)(Y.Ib(D))},e.\u0275cmp=Y.Cb({type:e,selectors:[["xm-movie"]],features:[Y.wb([D])],decls:21,vars:6,consts:[[1,"movies"],["xmBtn","","xmRipples","",3,"click"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(Y.Ob(0,"div",0),Y.Ob(1,"button",1),Y.Ub("click",(function(){return t.initMovie()})),Y.qc(2,"init movies"),Y.Nb(),Y.Ob(3,"button",1),Y.Ub("click",(function(){return t.addMovie()})),Y.qc(4,"add movie"),Y.Nb(),Y.Ob(5,"button",1),Y.Ub("click",(function(){return t.addMovies()})),Y.qc(6,"add movies"),Y.Nb(),Y.Ob(7,"button",1),Y.Ub("click",(function(){return t.addXmlyMovies()})),Y.qc(8,"add xmly movies"),Y.Nb(),Y.Ob(9,"button",1),Y.Ub("click",(function(){return t.resetMovies()})),Y.qc(10,"reset movies"),Y.Nb(),Y.Ob(11,"h3"),Y.qc(12,"movie list"),Y.Nb(),Y.Ob(13,"ul"),Y.oc(14,K,2,1,"li",2),Y.Yb(15,"ngrxPush"),Y.Nb(),Y.Ob(16,"h4"),Y.qc(17,"hot movies"),Y.Nb(),Y.Ob(18,"ul"),Y.oc(19,L,2,1,"li",2),Y.Yb(20,"ngrxPush"),Y.Nb(),Y.Nb()),2&e&&(Y.xb(14),Y.cc("ngForOf",Y.Zb(15,2,t.movies$)),Y.xb(5),Y.cc("ngForOf",Y.Zb(20,4,t.hotMovies)))},directives:[R.a,H.a,s.s],pipes:[n.b],encapsulation:2,changeDetection:0}),e})()}];let Q=(()=>{class e{}return e.\u0275mod=Y.Gb({type:e}),e.\u0275inj=Y.Fb({factory:function(t){return new(t||e)},imports:[[o.i.forChild(Z)],o.i]}),e})();var ee=i("BPEz");let te=(()=>{class e{}return e.\u0275mod=Y.Gb({type:e}),e.\u0275inj=Y.Fb({factory:function(t){return new(t||e)},imports:[[s.c,Q,ee.a,n.c]]}),e})()}}]);